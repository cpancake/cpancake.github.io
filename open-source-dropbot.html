<!DOCTYPE html>
<html lang="en">
<head>
		<title>Now Open Source: DropBot - the andrew rogers webzone</title>
		<meta charset="utf-8" />
		<link href='//fonts.googleapis.com/css?family=Montserrat:300i,700|Taviraj:400,400i,700' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="/theme/css/style.min.css">
	


		<meta name="tags" contents="projects" />

</head>

<body id="index" class="home">
	<div class="header">
		<header id="banner" class="body">
				<h1><a class="uilink" href="/">the andrew rogers webzone <strong></strong></a></h1>
		</header><!-- /#banner -->
		<nav id="menu">
			<ul>
				<li><a href="/">Home</a></li>
				<li><a href="/category/games.html">Games</a></li>
				<li><a href="/category/projects.html">Projects</a></li>
				<li><a href="/category/programming.html">Programming</a></li>
				<li><a href="/category/misc.html">Misc</a></li>

				<br>
				<li><a href="/portfolio/">Portfolio</a></li>
			</ul>
		</nav><!-- /#menu -->
	</div>
	<div class="container">
		<div class="content">
<section id="content" class="body">
	<div class="article-header">
		<h2 class="entry-title">Now Open Source: DropBot</h2>
 
	</div>
	<div class="post-info">
		<abbr class="published" title="2017-10-26T09:10:00-04:00">Thu 26 October 2017</abbr>
		<address class="vcard author">
			by 					<a class="url fn" href="/author/andrew-rogers.html">Andrew Rogers</a>
		</address>
		in <a href="/category/projects.html">Projects</a>
	</div><!-- /.post-info -->
	<div class="entry-content">
		<p>About a year and a half ago, I was getting back into Old School Runescape. You sit down to grind a bunch of skills, like woodcutting or whatever, and then you just have to Right Click -&gt; Drop for every item in your inventory. It's frustrating.</p>
<p>To address this complaint of mine with Runescape, I created the Runescape "<a href="https://cpancake.me/runescape-bot.html">DropBot</a>" the May before last. This was a program that analyzed an image of the game window and extracted the positions of the inventory items, then used the real mouse cursor to go through and drop every one. It's not nearly the most efficient option, but it's sure as hell difficult to detect on their end, and it worked.</p>
<p>I said in the original post that I wasn't releasing it until I fixed all the bugs and removed some of the default assumptions (resizing the screen, or playing as a free member, would make the tool break). What I didn't realize when writing that post is that I would stop playing Runescape shortly after finishing the bot. The code's sat untouched since then.</p>
<p>I decided to dig it out and give it a proper open-sourcing, just in case anyone wants to take a look</p>
<ul>
<li><a href="https://github.com/cpancake/DropBot">View source code.</a></li>
</ul>
<h2>How It Works</h2>
<p>Here's how the bot breaks down the steps:</p>
<ol>
<li>Takes a screenshot of the game window.</li>
<li>Extracts the inventory section of the screenshot using a hardcoded position and size.</li>
<li>Divides up the inventory image into seperate images for each inventory item.</li>
<li>Discards empty items.</li>
<li>Remove the background of every image, using hardcoded background color values (since the background is all shades of brown).</li>
<li>Hash each image using <a href="http://www.hackerfactor.com/blog/?/archives/432-Looks-Like-It.html">aHash</a>.</li>
<li>Merge together similar looking items, since they're probably the same item.</li>
<li>Present the list of items to the user.</li>
</ol>
<p>Then, when the user selects an item to drop:</p>
<ol>
<li>Takes the list of items computed previously.</li>
<li>Lerps to the position of the first item.</li>
<li>Right clicks on it.</li>
<li>Lerps to the position of the "Drop" button.</li>
<li>Clicks on it.</li>
<li>Repeats 2-5 for each item of the selected type.</li>
</ol>
<p>You might notice that this process is actually pretty simple, algorithm wise, save for the image hashing. Originally, the plan was to remove the background and compare the images pixel by pixel, because they all <em>should</em> be the same sprite. However, this proved to be rather difficult - it required each image be aligned in the same way, and all the background pixels to be removed perfectly. This ended up being too much effort, and I implemented image hashing instead.</p>
	</div><!-- /.entry-content -->
</section>

<div id="disqus_thread"></div>
<script type="text/javascript">
	this.page = {};
    var disqus_shortname = 'commiesprogblog'; 
    var disqus_config = function() {
    	this.page.url = "http://" + window.location.hostname + window.location.pathname;
    	this.page.identifier = this.page.url;
    	this.page.title = "Now Open Source: DropBot";
    };

    (function() {
        var d = document, s = d.createElement('script');
        
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js'; 
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		</div>
		<footer id="contentinfo">
			<address id="about" class="vcard body">
				<p>
					Written by <span class="fn">Andrew Rogers</span> (<span class="nickname">cpancake</span>) - contact me at <span class="email">andrew@<span class="email-obscure">lame-spam-bots-</span><span class="email-dont-obscure">cpancak</span>e.me</span>
				</p>
				<p>
					Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
				</p>
			</address><!-- /#about -->
		</footer><!-- /#contentinfo -->
		<!-- Matomo -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//the-nsa.anime.lgbt/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', '2']);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//the-nsa.anime.lgbt/piwik.php?idsite=2&rec=1" style="border:0;" alt="" /></p></noscript>
		<!-- End Matomo Code -->
	</div>
</body>
</html>